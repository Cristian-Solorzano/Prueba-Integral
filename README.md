# Prueba-Integral
Repositorio para la prueba integral de PLSQL, Spring Boot y Angular.

-- Archivo inicial para los retos de PLSQL
-- Estructuraremos los retos del 1 al 5 en este archivo

-- RETO 1: Modelo de Datos
-- Crear tablas Comerciantes y Establecimientos
CREATE TABLE Comerciantes (
    ComercianteID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    Nombre VARCHAR2(100) NOT NULL,
    Departamento VARCHAR2(50) NOT NULL,
    Municipio VARCHAR2(50) NOT NULL,
    Telefono VARCHAR2(15),
    CorreoElectronico VARCHAR2(100),
    FechaRegistro DATE NOT NULL,
    Estado VARCHAR2(20) CHECK (Estado IN ('Registrado', 'Activo', 'Inactivo', 'Suspendido', 'Cancelado')) NOT NULL,
    FechaActualizacion DATE,
    UsuarioActualizacion VARCHAR2(50)
);

CREATE TABLE Establecimientos (
    EstablecimientoID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ComercianteID NUMBER REFERENCES Comerciantes(ComercianteID),
    Nombre VARCHAR2(100) NOT NULL,
    Ingresos NUMBER(15, 2) NOT NULL,
    NumeroEmpleados NUMBER NOT NULL,
    FechaActualizacion DATE,
    UsuarioActualizacion VARCHAR2(50)
);

-- RETO 2: Secuencias y Triggers para IDs y Auditoría
CREATE SEQUENCE ComerciantesSeq START WITH 1;
CREATE SEQUENCE EstablecimientosSeq START WITH 1;

CREATE OR REPLACE TRIGGER trg_comerciantes_auditoria
BEFORE INSERT OR UPDATE ON Comerciantes
FOR EACH ROW
BEGIN
    :NEW.FechaActualizacion := SYSDATE;
    :NEW.UsuarioActualizacion := USER;
END;
/

CREATE OR REPLACE TRIGGER trg_establecimientos_auditoria
BEFORE INSERT OR UPDATE ON Establecimientos
FOR EACH ROW
BEGIN
    :NEW.FechaActualizacion := SYSDATE;
    :NEW.UsuarioActualizacion := USER;
END;
/

-- RETO 3: Datos Semilla
INSERT INTO Comerciantes (Nombre, Departamento, Municipio, Telefono, CorreoElectronico, FechaRegistro, Estado) 
VALUES ('Comerciante 1', 'Bogotá', 'Bogotá D.C.', '123456789', 'correo1@correo.com', SYSDATE, 'Activo');
-- Repetir para completar 10 registros.

INSERT INTO Establecimientos (ComercianteID, Nombre, Ingresos, NumeroEmpleados) 
VALUES (1, 'Establecimiento 1', 15000.50, 5);
-- Repetir para completar 30 registros.
